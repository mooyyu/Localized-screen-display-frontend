<template>
    <div class="main w-100 mx-0 bg-light p-3">
        <div class="showSvg mx-auto w-100 mb-3 border rounded">
            <svg viewBox="0 0 300 100" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <radialGradient id="gradient-0" gradientUnits="userSpaceOnUse" cx="235.707" cy="208.945" r="63.38">
                        <stop offset="0" style="stop-color: rgba(136, 216, 105, 1)"></stop>
                        <stop offset="1" style="stop-color: rgba(82, 174, 45, 1)"></stop>
                    </radialGradient>
                    <linearGradient id="gradient-1" gradientUnits="userSpaceOnUse" x1="235.707" y1="145.565" x2="235.707" y2="272.325">
                        <stop offset="0" style="stop-color: rgba(136, 216, 105, 1)"></stop>
                        <stop offset="1" style="stop-color: rgba(82, 174, 45, 1)"></stop>
                    </linearGradient>
                    <radialGradient id="gradient-2" gradientUnits="userSpaceOnUse" cx="235.707" cy="208.945" r="63.38">
                        <stop offset="0" style="stop-color: rgba(136, 216, 105, 1)"></stop>
                        <stop offset="1" style="stop-color: rgba(82, 174, 45, 1)"></stop>
                    </radialGradient>
                    <linearGradient id="gradient-3" gradientUnits="userSpaceOnUse" x1="235.707" y1="145.565" x2="235.707" y2="272.325">
                        <stop offset="0" style="stop-color: rgba(136, 216, 105, 1)"></stop>
                        <stop offset="1" style="stop-color: rgba(82, 174, 45, 1)"></stop>
                    </linearGradient>
                    <pattern id="pattern-0" x="0" y="0" width="25" height="25" patternUnits="userSpaceOnUse" viewBox="0 0 100 100">
                        <rect x="0" y="0" width="50" height="100" style="fill: black;"></rect>
                    </pattern>
                    <pattern id="pattern-0-0" patternTransform="matrix(1, 0, 0, 1, 223.207077, 196.445229)" xlink:href="#pattern-0"></pattern>
                    <linearGradient id="gradient-4" gradientUnits="userSpaceOnUse" x1="235.707" y1="145.565" x2="235.707" y2="272.325" spreadMethod="pad">
                        <stop offset="0" style="stop-color: #bada55"></stop>
                        <stop offset="1" style="stop-color: #758d29"></stop>
                    </linearGradient>
                    <linearGradient id="gradient-5" gradientUnits="userSpaceOnUse" x1="235.707" y1="145.565" x2="235.707" y2="272.325">
                        <stop offset="0" style="stop-color: rgba(187, 218, 85, 1)"></stop>
                        <stop offset="1" style="stop-color: rgba(135, 165, 36, 1)"></stop>
                    </linearGradient>
                    <linearGradient id="gradient-6" gradientUnits="userSpaceOnUse" x1="235.707" y1="145.565" x2="235.707" y2="272.325">
                        <stop offset="0" style="stop-color: rgba(29, 192, 70, 1)"></stop>
                        <stop offset="1" style="stop-color: rgba(16, 103, 37, 1)"></stop>
                    </linearGradient>
                    <pattern id="pattern-0-1" patternTransform="matrix(1, 0, 0, 1, 223.207077, 196.445229)" xlink:href="#pattern-0"></pattern>
                    <radialGradient id="gradient-7" gradientUnits="userSpaceOnUse" cx="235.707" cy="208.945" r="63.38">
                        <stop offset="0" style="stop-color: #bada55"></stop>
                        <stop offset="1" style="stop-color: #758d29"></stop>
                    </radialGradient>
                    <linearGradient id="gradient-8" gradientUnits="userSpaceOnUse" x1="235.707" y1="145.565" x2="235.707" y2="272.325" gradientTransform="matrix(0.983304, 0.181972, -0.102289, 0.667063, -13.679151, 21.607866)">
                        <stop offset="0" style="stop-color: rgb(86, 229, 50);"></stop>
                        <stop offset="1" style="stop-color: rgb(19, 101, 9);"></stop>
                    </linearGradient>
                </defs>
                <rect x="0" y="0" width="300" height="100" :style="'fill: ' + colors[0] + ';'"></rect>
                <g>
                    <rect y="10" width="87.5" height="50" style="fill: rgb(139, 216, 127);"></rect>
                    <!--suppress HtmlUnknownAttribute, XmlUnboundNsPrefix -->
                    <g transform="matrix(1, 0, 0, 1, 1.596872, -1.53882)" bx:origin="0.510771 0.5">
                        <!--suppress HtmlUnknownAttribute, XmlUnboundNsPrefix -->
                        <path style="fill: url(#gradient-8);" transform="matrix(0.284741, 0, 0, 0.284741, -17.60273, -22.909571)" d="M 193.441 161.716 A 63.38 63.38 0 1 1 173.876 195.019 L 182.662 196.998 A 54.374 54.374 0 1 0 199.447 168.427 Z" bx:shape="pie 235.707 208.945 54.374 63.38 318.174 282.693 1@007206c0" bx:origin="0.469257 0.5"></path>
                        <!--suppress HtmlUnknownAttribute, XmlUnboundNsPrefix -->
                        <path d="M 47.171 51.122 Q 49.612 46.895 52.053 51.122 L 53.397 53.452 Q 55.838 57.679 50.957 57.679 L 48.267 57.679 Q 43.386 57.679 45.827 53.452 Z" style="fill: rgb(48, 156, 27);" transform="matrix(0.920498, 0.390746, -0.390746, 0.920498, 9.506385, -36.944359)" bx:shape="triangle 43.386 46.895 12.452 10.784 0.5 0.392 1@f62b32b6"></path>
                        <animateTransform attributeName="transform" attributeType="XML" type="rotate" from="0 50 36" to="360 50 36" dur="4s" repeatCount="indefinite"/>
                    </g>
                    <text style="fill: rgb(51, 51, 51); font-family: Oswald,serif; font-size: 16px; white-space: pre;" x="5" y="50">1</text>
                </g>
                <g>
                    <rect y="60" width="87.5" height="40" :style="'fill: ' + colors[2] + ';'"></rect>
                    <text style="fill: rgb(51, 51, 51); font-family: Oswald,serif; font-size: 16px; white-space: pre;" x="5" y="90">2</text>
                </g>
                <g>
                    <rect x="87.5" y="19" width="125" height="72" :style="'fill: ' + colors[3] + ';'"></rect>
                    <text style="fill: rgb(51, 51, 51); font-family: Oswald,serif; font-size: 16px; white-space: pre;" x="92.5" y="80">3</text>
                </g>
                <g>
                    <rect x="212.5" y="10" width="87.5" height="55" :style="'fill: ' + colors[4] + ';'"></rect>
                    <text style="fill: rgb(51, 51, 51); font-family: Oswald,serif; font-size: 16px; white-space: pre;" x="217.5" y="55">4</text>
                </g>
                <g>
                    <rect x="212.5" y="65" width="87.5" height="35" :style="'fill: ' + colors[5] + ';'"></rect>
                    <text style="fill: rgb(51, 51, 51); font-family: Oswald,serif; font-size: 16px; white-space: pre;" x="217.5" y="95">5</text>
                </g>
                <g>
                    <rect x="212.5" y="10" width="87.5" height="90" :style="'fill: ' + colors[6] + ';'"></rect>
                    <text style="fill: rgb(51, 51, 51); font-family: Oswald,serif; font-size: 16px; white-space: pre;" x="217.5" y="95">6</text>
                    <animate attributeName="opacity" values="0;1;1;0;0" dur="4s" repeatCount="indefinite"></animate>
                </g>
            </svg>
        </div>
        <div class="alert alert-light border" role="alert">
            <h6 class="alert-heading">大宽屏</h6>
            <hr class="my-0">
            <p class="mb-0">适合宽高比5:2至3:1的大型屏幕。</p>
        </div>
        <div class="row">
            <div class="col-3 pr-0">
                <div class="list-group-flush border">
                    <div :style="'background-color: ' + colors[1] + ';'" class="list-group-item base3H">区域1</div>
                    <div :style="'background-color: ' + colors[2] + ';'" class="list-group-item">区域2</div>
                    <div :style="'background-color: ' + colors[3] + ';'" class="list-group-item">区域3</div>
                    <div :style="'background-color: ' + colors[4] + ';'" class="list-group-item">区域4</div>
                    <div :style="'background-color: ' + colors[5] + ';'" class="list-group-item">区域5</div>
                    <div :style="'background-color: ' + colors[6] + ';'" class="list-group-item">区域6</div>
                    <div :style="'background-color: ' + colors[0] + ';'" class="list-group-item base2H">隐藏</div>
                </div>
            </div>
            <div class="col-9 pl-0">
                <draggable class="list-group-flush border border-left-0" :list="list" group="people">
                    <div class="list-group-item" v-for="item in list" :key="item.name + item.id">
                        {{ item.name }}
                    </div>
                </draggable>
            </div>
        </div>
        <div class="btn-group w-100 mx-auto mt-3" role="group">
            <button @click="useDefaultList" type="button" class="btn btn-outline-primary">使用默认</button>
            <button @click="submit" type="button" class="btn btn-outline-success">确认提交</button>
        </div>
        <modal id="modulePanel" title="提交信息" :body="modalBody"></modal>
    </div>
</template>

<script>
    import draggable from 'vuedraggable';

    import modal from "@components/bootstrap/modal";
    import 'bootstrap/dist/js/bootstrap.min'
    import $ from 'jquery'

    export default {
        name: "overView",
        components: {
            modal, draggable
        },
        props: {
            overviewStatus: Object
        },
        data() {
            return {
                colors: [
                    'rgb(216, 216, 216)',
                    'rgb(139, 216, 127)',
                    'rgb(105, 173, 216)',
                    'rgb(220, 110, 110)',
                    'rgb(241, 3, 229)',
                    'rgb(211, 202, 66)',
                    'rgb(209,209,255)'
                ],
                list: null,
                modalBody: '',
                defaultList: 'dehgabifcj'
            }
        },
        mounted() {
            this.list = this.global.moduleList;
            if (this.overviewStatus.panelCode === this.$parent.rawPanelCode) {
                this.list.sort((a, b) => this.overviewStatus.moduleCodeList.indexOf(a.id) - this.overviewStatus.moduleCodeList.indexOf(b.id))
            } else {
                this.useDefaultList()
            }
        },
        methods: {
            submit() {
                let newModuleCodeList = this.list.map(item => item.id).join("");
                this.global.axios.post(this.global.serverHost + '/backStage/setOverviewStatus', {
                    panelCode: 1,
                    moduleCodeList: newModuleCodeList
                }, {
                    withCredentials: true
                }).then(() => {
                    this.modalBody = "更新成功";
                    $('div#modulePanelModal').on('hidden.bs.modal', () => {window.location.reload()})
                }).catch(e => {
                    // eslint-disable-next-line no-console
                    console.info(e);
                    this.modalBody = "失败!";
                }).finally(() => {
                    $('div#modulePanelModal').modal('show')
                })
            },
            useDefaultList() {
                this.list.sort((a, b) => this.defaultList.indexOf(a.id) - this.defaultList.indexOf(b.id))
            }
        }
    }
</script>

<style scoped>

</style>